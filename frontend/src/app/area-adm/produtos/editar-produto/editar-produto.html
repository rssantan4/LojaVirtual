<app-navbar-interno-adm></app-navbar-interno-adm>
<div class="container-editar">

  <h2>Editar Produto</h2>

  <!-- Campo para buscar produto -->
  <mat-form-field appearance="outline" class="campo-busca">
    <mat-label>Buscar produto</mat-label>
    <input matInput placeholder="Digite o nome do produto" [(ngModel)]="buscaProduto"
      (input)="filtrarProdutos()">
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <!-- Lista de produtos filtrados -->
  <div class="lista-produtos" *ngIf="produtosFiltrados.length > 0">
    <div class="produto-item" *ngFor="let produto of produtosFiltrados">

      <img [src]="produto.imagemUrl" alt="Imagem" class="produto-img">

      <div class="produto-info">
        <h3>{{ produto.nome }}</h3>
        <p><strong>Preço:</strong> R$ {{ produto.preco | number:'1.2-2' }}</p>
        <p><strong>Gênero Musical:</strong> {{ produto.generoMusical.nome }}</p>
        <p><strong>Estoque:</strong> {{ produto.estoque }}</p>
        <p><strong>Descrição: </strong>{{produto.descricao}}</p>
      </div>

      <button mat-raised-button color="primary" class="button-color" (click)="abrirConfirmacao(produto)">
        Editar
      </button>

    </div>
  </div>

  <!-- Nenhum resultado -->
  <p class="nenhum" *ngIf="buscaProduto && produtosFiltrados.length === 0">
    Nenhum produto encontrado.
  </p>

  <!-- Modal de edição -->
  <div class="modal-bg" *ngIf="produtoSelecionado">
    <div class="modal">
      <h3>Editar Produto</h3>

<mat-form-field appearance="outline">
  <mat-label>Nome</mat-label>
  <input matInput [(ngModel)]="produtoSelecionado!.nome" name="nome" required>
  <mat-error *ngIf="!produtoSelecionado!.nome || produtoSelecionado!.nome.trim() === ''">
    Nome é obrigatório
  </mat-error>
</mat-form-field>

<mat-form-field appearance="outline">
  <mat-label>Preço</mat-label>
  <input matInput type="number" [(ngModel)]="produtoSelecionado!.preco" name="preco" required min="0">
  <mat-error *ngIf="produtoSelecionado!.preco == null || produtoSelecionado!.preco < 0">
    Preço deve ser maior ou igual a 0
  </mat-error>
</mat-form-field>

<mat-form-field appearance="outline">
  <mat-label>Gênero Musical</mat-label>
  <mat-select [(ngModel)]="produtoSelecionado!.generoMusical" name="genero" required>
    <mat-option *ngFor="let genero of generosMusicais" [value]="genero">
      {{ genero.nome }}
    </mat-option>
  </mat-select>
  <mat-error *ngIf="!produtoSelecionado!.generoMusical?.id">
    Selecione um gênero musical
  </mat-error>
</mat-form-field>

<mat-form-field appearance="outline">
  <mat-label>Estoque</mat-label>
  <input matInput type="number" [(ngModel)]="produtoSelecionado!.estoque" name="estoque" required min="0">
  <mat-error *ngIf="produtoSelecionado!.estoque == null || produtoSelecionado!.estoque < 0">
    Estoque deve ser maior ou igual a 0
  </mat-error>
</mat-form-field>

<mat-form-field appearance="outline">
  <mat-label>Descrição</mat-label>
  <input matInput [(ngModel)]="produtoSelecionado!.descricao" name="descricao" required>
  <mat-error *ngIf="!produtoSelecionado!.descricao || produtoSelecionado!.descricao.trim() === ''">
    Descrição é obrigatória
  </mat-error>
</mat-form-field>


      <div class="botoes-modal">
        <button class="button-color" mat-raised-button (click)="produtoSelecionado = null">Cancelar</button>
        <button class="button-color" mat-raised-button color="primary" (click)="EditarProduto()">Salvar</button>
      </div>
    </div>
  </div>

</div>
